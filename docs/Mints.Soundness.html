<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Mints.Soundness</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>

<a id="85" class="Comment">-- Proof of the soundness theorem</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- If a term is well-typed, then it is equivalent to its βη normal form.</a>
<a id="195" class="Keyword">module</a> <a id="202" href="Mints.Soundness.html" class="Module">Mints.Soundness</a> <a id="218" class="Symbol">(</a><a id="219" href="Mints.Soundness.html#219" class="Bound">fext</a> <a id="224" class="Symbol">:</a> <a id="226" class="Symbol">∀</a> <a id="228" class="Symbol">{</a><a id="229" href="Mints.Soundness.html#229" class="Bound">ℓ</a> <a id="231" href="Mints.Soundness.html#231" class="Bound">ℓ′</a><a id="233" class="Symbol">}</a> <a id="235" class="Symbol">→</a> <a id="237" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="252" href="Mints.Soundness.html#229" class="Bound">ℓ</a> <a id="254" href="Mints.Soundness.html#231" class="Bound">ℓ′</a><a id="256" class="Symbol">)</a> <a id="258" class="Keyword">where</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Lib.html" class="Module">Lib</a>

<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Mints.Statics.Properties.html" class="Module">Mints.Statics.Properties</a>
<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Mints.Semantics.Readback.html" class="Module">Mints.Semantics.Readback</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Mints.Semantics.Properties.Domain.html" class="Module">Mints.Semantics.Properties.Domain</a> <a id="402" href="Mints.Soundness.html#219" class="Bound">fext</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Mints.Semantics.Properties.PER.html" class="Module">Mints.Semantics.Properties.PER</a> <a id="450" href="Mints.Soundness.html#219" class="Bound">fext</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Mints.Completeness.Fundamental.html" class="Module">Mints.Completeness.Fundamental</a> <a id="498" href="Mints.Soundness.html#219" class="Bound">fext</a>
<a id="503" class="Keyword">open</a> <a id="508" class="Keyword">import</a> <a id="515" href="Mints.Soundness.LogRel.html" class="Module">Mints.Soundness.LogRel</a>
<a id="538" class="Keyword">open</a> <a id="543" class="Keyword">import</a> <a id="550" href="Mints.Soundness.Properties.Substitutions.html" class="Module">Mints.Soundness.Properties.Substitutions</a> <a id="591" href="Mints.Soundness.html#219" class="Bound">fext</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Mints.Soundness.Realizability.html" class="Module">Mints.Soundness.Realizability</a> <a id="638" href="Mints.Soundness.html#219" class="Bound">fext</a>
<a id="643" class="Keyword">open</a> <a id="648" class="Keyword">import</a> <a id="655" href="Mints.Soundness.Fundamental.html" class="Module">Mints.Soundness.Fundamental</a> <a id="683" href="Mints.Soundness.html#219" class="Bound">fext</a>


<a id="soundness"></a><a id="690" href="Mints.Soundness.html#690" class="Function">soundness</a> <a id="700" class="Symbol">:</a> <a id="702" href="Mints.Statics.Syntax.html#3660" class="Generalizable">Γ</a> <a id="704" href="Mints.Statics.Concise.html#1144" class="Datatype Operator">⊢</a> <a id="706" href="Mints.Statics.Syntax.html#3694" class="Generalizable">t</a> <a id="708" href="Mints.Statics.Concise.html#1144" class="Datatype Operator">∶</a> <a id="710" href="Mints.Statics.Syntax.html#3607" class="Generalizable">T</a> <a id="712" class="Symbol">→</a>
            <a id="726" href="Data.Product.html#1369" class="Function">∃</a> <a id="728" class="Symbol">λ</a> <a id="730" href="Mints.Soundness.html#730" class="Bound">w</a> <a id="732" class="Symbol">→</a> <a id="734" href="Mints.Semantics.Readback.html#6155" class="Record">NbE</a> <a id="738" href="Mints.Statics.Syntax.html#3660" class="Generalizable">Γ</a> <a id="740" href="Mints.Statics.Syntax.html#3694" class="Generalizable">t</a> <a id="742" href="Mints.Statics.Syntax.html#3607" class="Generalizable">T</a> <a id="744" href="Mints.Soundness.html#730" class="Bound">w</a> <a id="746" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="748" href="Mints.Statics.Syntax.html#3660" class="Generalizable">Γ</a> <a id="750" href="Mints.Statics.Concise.html#3943" class="Datatype Operator">⊢</a> <a id="752" href="Mints.Statics.Syntax.html#3694" class="Generalizable">t</a> <a id="754" href="Mints.Statics.Concise.html#3943" class="Datatype Operator">≈</a> <a id="756" href="Mints.Statics.Syntax.html#4105" class="Function">Nf⇒Exp</a> <a id="763" href="Mints.Soundness.html#730" class="Bound">w</a> <a id="765" href="Mints.Statics.Concise.html#3943" class="Datatype Operator">∶</a> <a id="767" href="Mints.Statics.Syntax.html#3607" class="Generalizable">T</a>
<a id="769" href="Mints.Soundness.html#690" class="Function">soundness</a> <a id="779" class="Symbol">{</a><a id="780" href="Mints.Soundness.html#780" class="Bound">Γ</a><a id="781" class="Symbol">}</a> <a id="783" class="Symbol">{</a><a id="784" href="Mints.Soundness.html#784" class="Bound">t</a><a id="785" class="Symbol">}</a> <a id="787" class="Symbol">{</a><a id="788" href="Mints.Soundness.html#788" class="Bound">T</a><a id="789" class="Symbol">}</a> <a id="791" href="Mints.Soundness.html#791" class="Bound">⊢t</a>
  <a id="796" class="Keyword">with</a> <a id="801" class="Keyword">record</a> <a id="808" class="Symbol">{</a> <a id="810" href="Mints.Soundness.LogRel.html#15402" class="Field">⊩Γ</a> <a id="813" class="Symbol">=</a> <a id="815" href="Mints.Soundness.html#815" class="Bound">⊩Γ</a> <a id="818" class="Symbol">;</a> <a id="820" href="Mints.Soundness.LogRel.html#15533" class="Field">krip</a> <a id="825" class="Symbol">=</a> <a id="827" href="Mints.Soundness.html#827" class="Bound">krip</a> <a id="832" class="Symbol">}</a> ← <a id="836" href="Mints.Soundness.Fundamental.html#3222" class="Function">fundamental-⊢t⇒⊩t</a> <a id="854" href="Mints.Soundness.html#791" class="Bound">⊢t</a>
    <a id="861" class="Keyword">with</a> <a id="866" href="Mints.Soundness.html#866" class="Bound">ρ</a> <a id="868" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="870" class="Symbol">_</a> <a id="872" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="874" href="Mints.Soundness.html#874" class="Bound">ρinit</a> <a id="880" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="882" class="Symbol">_</a> ← <a id="886" href="Mints.Semantics.Properties.PER.html#32014" class="Function">InitEnvs-related</a> <a id="903" class="Symbol">(</a><a id="904" href="Mints.Completeness.Fundamental.html#864" class="Function">fundamental-⊢Γ</a> <a id="919" class="Symbol">(</a><a id="920" href="Mints.Soundness.LogRel.html#14717" class="Function">⊩⇒⊢</a> <a id="924" href="Mints.Soundness.html#815" class="Bound">⊩Γ</a><a id="926" class="Symbol">))</a>
     <a id="934" class="Keyword">with</a> <a id="939" class="Keyword">record</a> <a id="946" class="Symbol">{</a> <a id="948" href="Mints.Soundness.LogRel.html#14967" class="Field">⟦T⟧</a> <a id="952" class="Symbol">=</a> <a id="954" href="Mints.Soundness.html#954" class="Bound">⟦T⟧</a> <a id="958" class="Symbol">;</a> <a id="960" href="Mints.Soundness.LogRel.html#14981" class="Field">⟦t⟧</a> <a id="964" class="Symbol">=</a> <a id="966" href="Mints.Soundness.html#966" class="Bound">⟦t⟧</a> <a id="970" class="Symbol">;</a> <a id="972" href="Mints.Soundness.LogRel.html#14995" class="Field">↘⟦T⟧</a> <a id="977" class="Symbol">=</a> <a id="979" href="Mints.Soundness.html#979" class="Bound">↘⟦T⟧</a> <a id="984" class="Symbol">;</a> <a id="986" href="Mints.Soundness.LogRel.html#15021" class="Field">↘⟦t⟧</a> <a id="991" class="Symbol">=</a> <a id="993" href="Mints.Soundness.html#993" class="Bound">↘⟦t⟧</a> <a id="998" class="Symbol">;</a> <a id="1000" href="Mints.Soundness.LogRel.html#15047" class="Field">T∈𝕌</a> <a id="1004" class="Symbol">=</a> <a id="1006" href="Mints.Soundness.html#1006" class="Bound">T∈𝕌</a> <a id="1010" class="Symbol">;</a> <a id="1012" href="Mints.Soundness.LogRel.html#15070" class="Field">t∼⟦t⟧</a> <a id="1018" class="Symbol">=</a> <a id="1020" href="Mints.Soundness.html#1020" class="Bound">t∼⟦t⟧</a> <a id="1026" class="Symbol">}</a> ← <a id="1030" href="Mints.Soundness.html#827" class="Bound">krip</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Mints.Soundness.Properties.Substitutions.html#14759" class="Function">InitEnvs⇒s®I</a> <a id="1049" href="Mints.Soundness.html#815" class="Bound">⊩Γ</a> <a id="1052" href="Mints.Soundness.html#874" class="Bound">ρinit</a><a id="1057" class="Symbol">)</a>
        <a id="1067" class="Keyword">with</a> <a id="1072" class="Keyword">record</a> <a id="1079" class="Symbol">{</a> <a id="1081" href="Mints.Soundness.LogRel.html#10847" class="Field">a∈⊤</a> <a id="1085" class="Symbol">=</a> <a id="1087" href="Mints.Soundness.html#1087" class="Bound">a∈⊤</a> <a id="1091" class="Symbol">;</a> <a id="1093" href="Mints.Soundness.LogRel.html#10878" class="Field">krip</a> <a id="1098" class="Symbol">=</a> <a id="1100" href="Mints.Soundness.html#1100" class="Bound">krip</a> <a id="1105" class="Symbol">}</a> ← <a id="1109" href="Mints.Soundness.Realizability.html#26850" class="Function">®El⇒®↑El</a> <a id="1118" href="Mints.Soundness.html#1006" class="Bound">T∈𝕌</a> <a id="1122" href="Mints.Soundness.html#1020" class="Bound">t∼⟦t⟧</a>
           <a id="1139" class="Keyword">with</a> <a id="1144" href="Mints.Soundness.html#1144" class="Bound">w</a> <a id="1146" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1148" href="Mints.Soundness.html#1148" class="Bound">↘w</a> <a id="1151" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1153" class="Symbol">_</a> ← <a id="1157" href="Mints.Soundness.html#1087" class="Bound">a∈⊤</a> <a id="1161" class="Symbol">(</a><a id="1162" href="Data.List.NonEmpty.Base.html#2053" class="Function">map</a> <a id="1166" href="LibNonEmpty.html#717" class="Field">len</a> <a id="1170" href="Mints.Soundness.html#780" class="Bound">Γ</a><a id="1171" class="Symbol">)</a> <a id="1173" href="Mints.Semantics.Domain.html#6347" class="Function">vone</a>
              <a id="1192" class="Symbol">|</a> <a id="1194" href="Mints.Soundness.html#1194" class="Bound">eq</a> ← <a id="1199" href="Mints.Soundness.html#1100" class="Bound">krip</a> <a id="1204" class="Symbol">(</a><a id="1205" href="Mints.Soundness.Restricted.html#7393" class="Function">⊢rI</a> <a id="1209" class="Symbol">(</a><a id="1210" href="Mints.Soundness.LogRel.html#14717" class="Function">⊩⇒⊢</a> <a id="1214" href="Mints.Soundness.html#815" class="Bound">⊩Γ</a><a id="1216" class="Symbol">))</a>
             <a id="1232" class="Keyword">rewrite</a> <a id="1240" href="Mints.Semantics.Properties.Domain.html#6013" class="Function">D-ap-vone</a> <a id="1250" href="Mints.Soundness.html#966" class="Bound">⟦t⟧</a>
                   <a id="1273" class="Symbol">|</a> <a id="1275" href="Mints.Semantics.Properties.Domain.html#6013" class="Function">D-ap-vone</a> <a id="1285" href="Mints.Soundness.html#954" class="Bound">⟦T⟧</a> <a id="1289" class="Symbol">=</a> <a id="1291" href="Mints.Soundness.html#1144" class="Bound">w</a> <a id="1293" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1295" href="Mints.Soundness.html#1328" class="Function">nbe</a> <a id="1299" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1301" href="Mints.Statics.Properties.html#11228" class="Function">[I]-≈ˡ</a> <a id="1308" class="Symbol">(</a><a id="1309" href="Mints.Statics.Properties.html#11228" class="Function">[I]-≈ˡ</a> <a id="1316" href="Mints.Soundness.html#1194" class="Bound">eq</a><a id="1318" class="Symbol">)</a>
  <a id="1322" class="Keyword">where</a> <a id="1328" href="Mints.Soundness.html#1328" class="Function">nbe</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="Mints.Semantics.Readback.html#6155" class="Record">NbE</a> <a id="1338" href="Mints.Soundness.html#780" class="Bound">Γ</a> <a id="1340" href="Mints.Soundness.html#784" class="Bound">t</a> <a id="1342" href="Mints.Soundness.html#788" class="Bound">T</a> <a id="1344" href="Mints.Soundness.html#1144" class="Bound">w</a>
        <a id="1354" href="Mints.Soundness.html#1328" class="Function">nbe</a> <a id="1358" class="Symbol">=</a> <a id="1360" class="Keyword">record</a>
          <a id="1377" class="Symbol">{</a> <a id="1379" href="Mints.Semantics.Readback.html#6191" class="Field">envs</a> <a id="1384" class="Symbol">=</a> <a id="1386" href="Mints.Soundness.html#866" class="Bound">ρ</a>
          <a id="1398" class="Symbol">;</a> <a id="1400" href="Mints.Semantics.Readback.html#6207" class="Field">init</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="Mints.Soundness.html#874" class="Bound">ρinit</a>
          <a id="1423" class="Symbol">;</a> <a id="1425" href="Mints.Semantics.Readback.html#6234" class="Field">nbe</a>  <a id="1430" class="Symbol">=</a> <a id="1432" class="Keyword">record</a>
            <a id="1451" class="Symbol">{</a> <a id="1453" href="Mints.Semantics.Readback.html#5509" class="Field">⟦t⟧</a>  <a id="1458" class="Symbol">=</a> <a id="1460" href="Mints.Soundness.html#966" class="Bound">⟦t⟧</a>
            <a id="1476" class="Symbol">;</a> <a id="1478" href="Mints.Semantics.Readback.html#5522" class="Field">⟦T⟧</a>  <a id="1483" class="Symbol">=</a> <a id="1485" href="Mints.Soundness.html#954" class="Bound">⟦T⟧</a>
            <a id="1501" class="Symbol">;</a> <a id="1503" href="Mints.Semantics.Readback.html#5535" class="Field">↘⟦t⟧</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="Mints.Soundness.html#993" class="Bound">↘⟦t⟧</a>
            <a id="1527" class="Symbol">;</a> <a id="1529" href="Mints.Semantics.Readback.html#5560" class="Field">↘⟦T⟧</a> <a id="1534" class="Symbol">=</a> <a id="1536" href="Mints.Soundness.html#979" class="Bound">↘⟦T⟧</a>
            <a id="1553" class="Symbol">;</a> <a id="1555" href="Mints.Semantics.Readback.html#5585" class="Field">↓⟦t⟧</a> <a id="1560" class="Symbol">=</a> <a id="1562" href="Mints.Soundness.html#1148" class="Bound">↘w</a>
            <a id="1577" class="Symbol">}</a>
          <a id="1589" class="Symbol">}</a>
</pre></body></html>