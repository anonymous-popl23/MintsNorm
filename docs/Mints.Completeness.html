<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Mints.Completeness</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>

<a id="85" class="Comment">-- Proof of the completeness theorem</a>
<a id="122" class="Comment">--</a>
<a id="125" class="Comment">-- If two terms are equivalent, then they have equal βη normal form.</a>
<a id="194" class="Keyword">module</a> <a id="201" href="Mints.Completeness.html" class="Module">Mints.Completeness</a> <a id="220" class="Symbol">(</a><a id="221" href="Mints.Completeness.html#221" class="Bound">fext</a> <a id="226" class="Symbol">:</a> <a id="228" class="Symbol">∀</a> <a id="230" class="Symbol">{</a><a id="231" href="Mints.Completeness.html#231" class="Bound">ℓ</a> <a id="233" href="Mints.Completeness.html#233" class="Bound">ℓ′</a><a id="235" class="Symbol">}</a> <a id="237" class="Symbol">→</a> <a id="239" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="254" href="Mints.Completeness.html#231" class="Bound">ℓ</a> <a id="256" href="Mints.Completeness.html#233" class="Bound">ℓ′</a><a id="258" class="Symbol">)</a> <a id="260" class="Keyword">where</a>

<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Lib.html" class="Module">Lib</a>
<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Mints.Completeness.Fundamental.html" class="Module">Mints.Completeness.Fundamental</a> <a id="326" href="Mints.Completeness.html#221" class="Bound">fext</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Mints.Semantics.Domain.html" class="Module">Mints.Semantics.Domain</a>
<a id="366" class="Keyword">open</a> <a id="371" class="Keyword">import</a> <a id="378" href="Mints.Semantics.Evaluation.html" class="Module">Mints.Semantics.Evaluation</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Mints.Semantics.Properties.Domain.html" class="Module">Mints.Semantics.Properties.Domain</a> <a id="451" href="Mints.Completeness.html#221" class="Bound">fext</a>
<a id="456" class="Keyword">open</a> <a id="461" class="Keyword">import</a> <a id="468" href="Mints.Semantics.Properties.Evaluation.html" class="Module">Mints.Semantics.Properties.Evaluation</a> <a id="506" href="Mints.Completeness.html#221" class="Bound">fext</a>
<a id="511" class="Keyword">open</a> <a id="516" class="Keyword">import</a> <a id="523" href="Mints.Semantics.Properties.PER.html" class="Module">Mints.Semantics.Properties.PER</a> <a id="554" href="Mints.Completeness.html#221" class="Bound">fext</a>
<a id="559" class="Keyword">open</a> <a id="564" class="Keyword">import</a> <a id="571" href="Mints.Semantics.Readback.html" class="Module">Mints.Semantics.Readback</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Mints.Semantics.Realizability.html" class="Module">Mints.Semantics.Realizability</a> <a id="638" href="Mints.Completeness.html#221" class="Bound">fext</a>
<a id="643" class="Keyword">open</a> <a id="648" class="Keyword">import</a> <a id="655" href="Mints.Statics.html" class="Module">Mints.Statics</a>

<a id="completeness"></a><a id="670" href="Mints.Completeness.html#670" class="Function">completeness</a> <a id="683" class="Symbol">:</a> <a id="685" href="Mints.Statics.Syntax.html#3660" class="Generalizable">Γ</a> <a id="687" href="Mints.Statics.Concise.html#3943" class="Datatype Operator">⊢</a> <a id="689" href="Mints.Statics.Syntax.html#3694" class="Generalizable">t</a> <a id="691" href="Mints.Statics.Concise.html#3943" class="Datatype Operator">≈</a> <a id="693" href="Mints.Statics.Syntax.html#3696" class="Generalizable">t′</a> <a id="696" href="Mints.Statics.Concise.html#3943" class="Datatype Operator">∶</a> <a id="698" href="Mints.Statics.Syntax.html#3607" class="Generalizable">T</a> <a id="700" class="Symbol">→</a>
               <a id="717" href="Data.Product.html#1369" class="Function">∃</a> <a id="719" class="Symbol">λ</a> <a id="721" href="Mints.Completeness.html#721" class="Bound">w</a> <a id="723" class="Symbol">→</a> <a id="725" href="Mints.Semantics.Readback.html#6155" class="Record">NbE</a> <a id="729" href="Mints.Statics.Syntax.html#3660" class="Generalizable">Γ</a> <a id="731" href="Mints.Statics.Syntax.html#3694" class="Generalizable">t</a> <a id="733" href="Mints.Statics.Syntax.html#3607" class="Generalizable">T</a> <a id="735" href="Mints.Completeness.html#721" class="Bound">w</a> <a id="737" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="739" href="Mints.Semantics.Readback.html#6155" class="Record">NbE</a> <a id="743" href="Mints.Statics.Syntax.html#3660" class="Generalizable">Γ</a> <a id="745" href="Mints.Statics.Syntax.html#3696" class="Generalizable">t′</a> <a id="748" href="Mints.Statics.Syntax.html#3607" class="Generalizable">T</a> <a id="750" href="Mints.Completeness.html#721" class="Bound">w</a>
<a id="752" href="Mints.Completeness.html#670" class="Function">completeness</a> <a id="765" class="Symbol">{</a><a id="766" href="Mints.Completeness.html#766" class="Bound">Γ</a><a id="767" class="Symbol">}</a> <a id="769" href="Mints.Completeness.html#769" class="Bound">t≈t′</a>
  <a id="776" class="Keyword">with</a> <a id="781" href="Mints.Completeness.html#781" class="Bound">⊨Γ</a> <a id="784" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="786" class="Symbol">_</a> <a id="788" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="790" href="Mints.Completeness.html#790" class="Bound">t≈t′</a> ← <a id="797" href="Mints.Completeness.Fundamental.html#3152" class="Function">fundamental-t≈t′</a> <a id="814" href="Mints.Completeness.html#769" class="Bound">t≈t′</a>
    <a id="823" class="Keyword">with</a> <a id="828" class="Symbol">_</a> <a id="830" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="832" class="Symbol">_</a> <a id="834" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="836" href="Mints.Completeness.html#836" class="Bound">↘ρ</a> <a id="839" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="841" href="Mints.Completeness.html#841" class="Bound">↘ρ′</a> <a id="845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="847" href="Mints.Completeness.html#847" class="Bound">ρ≈ρ′</a> ← <a id="854" href="Mints.Semantics.Properties.PER.html#32014" class="Function">InitEnvs-related</a> <a id="871" href="Mints.Completeness.html#781" class="Bound">⊨Γ</a>
      <a id="880" class="Keyword">with</a> <a id="885" href="Mints.Completeness.html#790" class="Bound">t≈t′</a> <a id="890" href="Mints.Completeness.html#847" class="Bound">ρ≈ρ′</a>
<a id="895" class="Symbol">...</a>      <a id="904" class="Symbol">|</a> <a id="906" class="Keyword">record</a> <a id="913" class="Symbol">{</a> <a id="915" href="Mints.Semantics.PER.html#5291" class="Field">⟦T⟧</a> <a id="919" class="Symbol">=</a> <a id="921" href="Mints.Completeness.html#921" class="Bound">⟦T⟧</a> <a id="925" class="Symbol">;</a> <a id="927" href="Mints.Semantics.PER.html#5305" class="Field">⟦T′⟧</a> <a id="932" class="Symbol">=</a> <a id="934" href="Mints.Completeness.html#934" class="Bound">⟦T′⟧</a> <a id="939" class="Symbol">;</a> <a id="941" href="Mints.Semantics.PER.html#5319" class="Field">↘⟦T⟧</a> <a id="946" class="Symbol">=</a> <a id="948" href="Mints.Completeness.html#948" class="Bound">↘⟦T⟧</a> <a id="953" class="Symbol">;</a> <a id="955" href="Mints.Semantics.PER.html#5345" class="Field">↘⟦T′⟧</a> <a id="961" class="Symbol">=</a> <a id="963" href="Mints.Completeness.html#963" class="Bound">↘⟦T′⟧</a> <a id="969" class="Symbol">;</a> <a id="971" href="Mints.Semantics.PER.html#5374" class="Field">T≈T′</a> <a id="976" class="Symbol">=</a> <a id="978" href="Mints.Completeness.html#978" class="Bound">T≈T′</a> <a id="983" class="Symbol">}</a>
         <a id="994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="996" class="Keyword">record</a> <a id="1003" class="Symbol">{</a> <a id="1005" href="Mints.Completeness.LogRel.html#333" class="Field">⟦t⟧</a> <a id="1009" class="Symbol">=</a> <a id="1011" href="Mints.Completeness.html#1011" class="Bound">⟦t⟧</a> <a id="1015" class="Symbol">;</a> <a id="1017" href="Mints.Completeness.LogRel.html#347" class="Field">⟦t′⟧</a> <a id="1022" class="Symbol">=</a> <a id="1024" href="Mints.Completeness.html#1024" class="Bound">⟦t′⟧</a> <a id="1029" class="Symbol">;</a> <a id="1031" href="Mints.Completeness.LogRel.html#361" class="Field">↘⟦t⟧</a> <a id="1036" class="Symbol">=</a> <a id="1038" href="Mints.Completeness.html#1038" class="Bound">↘⟦t⟧</a> <a id="1043" class="Symbol">;</a> <a id="1045" href="Mints.Completeness.LogRel.html#387" class="Field">↘⟦t′⟧</a> <a id="1051" class="Symbol">=</a> <a id="1053" href="Mints.Completeness.html#1053" class="Bound">↘⟦t′⟧</a> <a id="1059" class="Symbol">;</a> <a id="1061" href="Mints.Completeness.LogRel.html#416" class="Field">t≈t′</a> <a id="1066" class="Symbol">=</a> <a id="1068" href="Mints.Completeness.html#1068" class="Bound">t≈t′</a> <a id="1073" class="Symbol">}</a>
         <a id="1084" class="Keyword">with</a> <a id="1089" class="Symbol">_</a> <a id="1091" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1093" href="Mints.Completeness.html#1093" class="Bound">↓⟦t⟧</a> <a id="1098" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1100" href="Mints.Completeness.html#1100" class="Bound">↓⟦t′⟧</a> ← <a id="1108" href="Mints.Semantics.Realizability.html#7333" class="Function">realizability-Rf</a> <a id="1125" href="Mints.Completeness.html#978" class="Bound">T≈T′</a> <a id="1130" href="Mints.Completeness.html#1068" class="Bound">t≈t′</a> <a id="1135" class="Symbol">(</a><a id="1136" href="Data.List.NonEmpty.Base.html#2053" class="Function">map</a> <a id="1140" href="LibNonEmpty.html#717" class="Field">len</a> <a id="1144" class="Bound">Γ</a><a id="1145" class="Symbol">)</a> <a id="1147" href="Mints.Semantics.Domain.html#6347" class="Function">vone</a>
           <a id="1163" class="Keyword">rewrite</a> <a id="1171" href="Mints.Semantics.Properties.Domain.html#6855" class="Function">Df-ap-vone</a> <a id="1182" class="Symbol">(</a><a id="1183" href="Mints.Semantics.Domain.html#2686" class="InductiveConstructor">↓</a> <a id="1185" href="Mints.Completeness.html#921" class="Bound">⟦T⟧</a> <a id="1189" href="Mints.Completeness.html#1011" class="Bound">⟦t⟧</a><a id="1192" class="Symbol">)</a>
                 <a id="1211" class="Symbol">|</a> <a id="1213" href="Mints.Semantics.Properties.Domain.html#6855" class="Function">Df-ap-vone</a> <a id="1224" class="Symbol">(</a><a id="1225" href="Mints.Semantics.Domain.html#2686" class="InductiveConstructor">↓</a> <a id="1227" href="Mints.Completeness.html#934" class="Bound">⟦T′⟧</a> <a id="1232" href="Mints.Completeness.html#1024" class="Bound">⟦t′⟧</a><a id="1236" class="Symbol">)</a> <a id="1238" class="Symbol">=</a> <a id="1240" class="Symbol">_</a>
                                           <a id="1285" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1287" class="Keyword">record</a>
                                             <a id="1339" class="Symbol">{</a> <a id="1341" href="Mints.Semantics.Readback.html#6207" class="Field">init</a> <a id="1346" class="Symbol">=</a> <a id="1348" href="Mints.Completeness.html#836" class="Bound">↘ρ</a>
                                             <a id="1396" class="Symbol">;</a> <a id="1398" href="Mints.Semantics.Readback.html#6234" class="Field">nbe</a> <a id="1402" class="Symbol">=</a> <a id="1404" class="Keyword">record</a>
                                                     <a id="1464" class="Symbol">{</a> <a id="1466" href="Mints.Semantics.Readback.html#5535" class="Field">↘⟦t⟧</a> <a id="1471" class="Symbol">=</a> <a id="1473" href="Mints.Completeness.html#1038" class="Bound">↘⟦t⟧</a>
                                                     <a id="1531" class="Symbol">;</a> <a id="1533" href="Mints.Semantics.Readback.html#5560" class="Field">↘⟦T⟧</a> <a id="1538" class="Symbol">=</a> <a id="1540" href="Mints.Completeness.html#948" class="Bound">↘⟦T⟧</a>
                                                     <a id="1598" class="Symbol">;</a> <a id="1600" href="Mints.Semantics.Readback.html#5585" class="Field">↓⟦t⟧</a> <a id="1605" class="Symbol">=</a> <a id="1607" href="Mints.Completeness.html#1093" class="Bound">↓⟦t⟧</a>
                                                     <a id="1665" class="Symbol">}</a>
                                             <a id="1712" class="Symbol">}</a>
                                           <a id="1757" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1759" class="Keyword">record</a>
                                             <a id="1811" class="Symbol">{</a> <a id="1813" href="Mints.Semantics.Readback.html#6207" class="Field">init</a> <a id="1818" class="Symbol">=</a> <a id="1820" href="Mints.Completeness.html#841" class="Bound">↘ρ′</a>
                                             <a id="1869" class="Symbol">;</a> <a id="1871" href="Mints.Semantics.Readback.html#6234" class="Field">nbe</a> <a id="1875" class="Symbol">=</a> <a id="1877" class="Keyword">record</a>
                                                     <a id="1937" class="Symbol">{</a> <a id="1939" href="Mints.Semantics.Readback.html#5535" class="Field">↘⟦t⟧</a> <a id="1944" class="Symbol">=</a> <a id="1946" href="Mints.Completeness.html#1053" class="Bound">↘⟦t′⟧</a>
                                                     <a id="2005" class="Symbol">;</a> <a id="2007" href="Mints.Semantics.Readback.html#5560" class="Field">↘⟦T⟧</a> <a id="2012" class="Symbol">=</a> <a id="2014" href="Mints.Completeness.html#963" class="Bound">↘⟦T′⟧</a>
                                                     <a id="2073" class="Symbol">;</a> <a id="2075" href="Mints.Semantics.Readback.html#5585" class="Field">↓⟦t⟧</a> <a id="2080" class="Symbol">=</a> <a id="2082" href="Mints.Completeness.html#1100" class="Bound">↓⟦t′⟧</a>
                                                     <a id="2141" class="Symbol">}</a>
                                             <a id="2188" class="Symbol">}</a>
</pre></body></html>